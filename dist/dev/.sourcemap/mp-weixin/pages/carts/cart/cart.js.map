{"version":3,"sources":["webpack:///./src/main.js","webpack:///./src/pages/carts/cart/cart.vue?946e","webpack:///./src/pages/carts/cart/cart.vue?a0e7","webpack:///./src/pages/carts/cart/cart.vue?e8c2","webpack:///./src/pages/carts/cart/cart.vue?cb07","webpack:///./src/pages/carts/cart/cart.vue","webpack:///./src/pages/carts/cart/cart.vue?1478"],"names":["createPage","Page","component","options","__file","render","_h","this","$createElement","_self","_c","staticRenderFns","_withStripped","createNamespacedHelpers","mapState","components","UniNumberBox","data","isWrapShow","cartData","isRadio","isLoding","purchaseQuantity","isProhibit","resultPrice","totalCommodity","onShow","navToLogin","$request","GET","url","$api","apiUrl","GET_GOODS_CART","then","res","length","slectAll","totalPrice","changeCartNum","methods","radioTap","POST","POST_CART_CHECK","i","element","is_check","jumpProduct","e","goodsRadio","index","findIndex","item","id","changeQuantity","mathematicalSymbols","goods_num","changeNumber","POST_SAVE_CART","goods_id","spec_id","uni","showToast","title","icon","detectionValue","target","dataset","num","detail","value","test","deleteGoods","showModal","content","success","confirm","GET_CART_DEL","cartDataItem","splice","cancel","find","resultArr","filter","Number","goods_price","toFixed","shoppingSettlement","navigateTo","setTabBarBadge","text","String","TOKEN","getStorageSync","switchTab"],"mappings":"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","file":"pages/carts/cart/cart.js","sourcesContent":["import 'uni-pages';\n\nimport Vue from 'vue'            \nimport Page from './pages/carts/cart/cart.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./cart.vue?vue&type=template&id=2b0d56c2&\"\nimport script from \"./cart.vue?vue&type=script&lang=js&\"\nexport * from \"./cart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cart.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/Rope/master/Desktop/mix-mall/cli_ShoppingMall/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('2b0d56c2')) {\n      api.createRecord('2b0d56c2', component.options)\n    } else {\n      api.reload('2b0d56c2', component.options)\n    }\n    module.hot.accept(\"./cart.vue?vue&type=template&id=2b0d56c2&\", function () {\n      api.rerender('2b0d56c2', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pages/carts/cart/cart.vue\"\nexport default component.exports","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=template&id=2b0d56c2&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { createNamespacedHelpers } from 'vuex';\nconst { mapState } = createNamespacedHelpers('storeCommodity');\nimport UniNumberBox from \"@/components/UniNumberBox/UniNumberBox\"\nexport default {\n  components: {\n    UniNumberBox,\n  },\n  data() {\n    return {\n      isWrapShow:false,\n      cartData:[],\n      isRadio:false,\n      isLoding:false,\n      purchaseQuantity:1,\n      isProhibit:true,\n      resultPrice:0,\n      totalCommodity:0\n    };\n  },\n  onShow(){\n    // 路由鉴权\n    this.navToLogin();\n    this.$request.GET({\n      url: this.$api.apiUrl.GET_GOODS_CART\n    }).then(res=>{\n      // 请求数据成功后控制页面显示状态\n      this.isLoding = true;\n      // 赋值数据\n      this.cartData = res.data\n      // 把数据数量告诉全选按钮,自动控制是否禁用\n      this.isProhibit = this.cartData.length;\n      // 查看列表内容是否全选\n      this.slectAll();\n      // 计算总价\n      const result = this.totalPrice();\n      // console.log(result);\n    })\n    // 每次进入时更改购物车显示数量\n\t\tthis.changeCartNum();\n   \n  },\n  methods: {\n    // 店铺和全选按钮点击\n    radioTap(){\n      // 请求后端全选/全不选接口\n      this.$request.POST({\n        url:this.$api.apiUrl.POST_CART_CHECK\n      }).then(res=>{\n        this.isRadio = !this.isRadio;\n        // 修改列表中所有显示字段\n        for (let i = 0; i < this.cartData.length; i++) {\n          const element = this.cartData[i];\n          if(this.isRadio){\n            element.is_check = 1;\n          }else{\n            element.is_check = 0;\n          }\n        }\n        // 修改商品显示价格;\n        this.totalPrice();      \n      })\n    },\n    jumpProduct(e){\n      // 跳到商品页面\n      // uni.navigateTo({\n      //   url: `/pages/goodss/product/product?id=${e}`,\n      // });\n    },\n    // 单个商品按钮点击，修改数据中的状态\n    goodsRadio(e){\n      let index = this.cartData.findIndex(function(item){\n          return item.id === e;\n      })\n      // 更改后端单个商品选中状态\n      this.$request.POST({\n        url:this.$api.apiUrl.POST_CART_CHECK,\n        data:{\n          id:this.cartData[index].id\n        }\n      }).then(res=>{\n        this.cartData[index].is_check = !this.cartData[index].is_check;\n        // 修改商品显示价格\n        this.totalPrice();\n        // 执行查看是否全选了\n        this.slectAll();\n      })\n    },\n    // 加减按钮执行\n    changeQuantity(mathematicalSymbols,index){\n\t\t\t// 增加于删除按钮\n\t\t\tif(mathematicalSymbols === \"+\"){\n        this.cartData[index].goods_num++\n        this.changeNumber(this.cartData[index])\n\t\t\t}else if(this.cartData[index].goods_num>1){\n        this.cartData[index].goods_num--\n        this.changeNumber(this.cartData[index])\n      }\n    },\n    // 更改数量接口\n    changeNumber(item){\n      this.$request.POST({\n\t\t\t\t\turl:this.$api.apiUrl.POST_SAVE_CART,\n\t\t\t\t\tdata:{\n\t\t\t\t\t\tgoods_id:item.goods_id,\n\t\t\t\t\t\tspec_id:item.spec_id,\n\t\t\t\t\t\tgoods_num:item.goods_num,\n\t\t\t\t\t}\n\t\t\t\t}).then(res=>{\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle:\"更改数量成功\",\n\t\t\t\t\t\t\ticon:\"none\"\n            })\n            // 更改数量修改显示价格;\n            this.totalPrice();\t\t\t\t\t\n\t\t\t\t})\n    },\n    // 直接修改input值，执行函数\n    detectionValue(e){\n      const index = e.target.dataset.id\n\t\t\tconst num = e.detail.value;\n\t\t\tif (num === \"\") {\n\t\t\t\t// 如果输入为空\n        this.cartData[index].goods_num = 1;\n        this.changeNumber(this.cartData[index])\n\t\t\t\treturn 1\n\t\t\t} else {\n\t\t\t\t// 判断值是否小于0或者是小数\n\t\t\t\tvar r = /^\\+?[1-9][0-9]*$/;\n\t\t\t\tif (r.test(num)) {\n          this.cartData[index].goods_num = num;\n          this.changeNumber(this.cartData[index])          \n\t\t\t\t\treturn num\n\t\t\t\t} else {\n\t\t\t\t\t// 如果数值不符合:大于0,并且是正整数\n          this.cartData[index].goods_num = 1;\n          this.changeNumber(this.cartData[index])          \n\t\t\t\t\treturn 1\n\t\t\t\t}\n\t\t\t}\n    },\n    // 删除商品\n    deleteGoods(item,index){\n      uni.showModal({\n        title: '消息提示',\n        content: '确定删除该商品',\n        success:  (res) => {\n            if (res.confirm) {\n                this.$request.GET({\n                  url:this.$api.apiUrl.GET_CART_DEL,\n                  data:{\n                    id:item.id\n                  }\n                }).then(res=>{\n                  // 请求删除接口成功后，再把页面显示中的也删除了\n                  let index = this.cartData.findIndex((cartDataItem,index)=>{\n                    return cartDataItem.id === item.id\n                  })\n                  this.cartData.splice(index, 1);\n                  // 全选按钮是否禁用\n                  this.isProhibit = this.cartData.length;\n                  // 检测选中多少函数,可页面不刷新更改全选状态\n                  this.slectAll();\n                  // 更改总价和数量\n                  this.totalPrice();\n                  // 更改角标\n\t\t              this.changeCartNum();\n                })\n            } else if (res.cancel) {\n              return false;\n            }\n        }\n    });\n    },\n    // 查看购物车列表选中情况，是否禁用全选按钮\n    slectAll(){\n      let index = this.cartData.find((item,index)=>{\n        // 看看有没有,没选中的\n        return item.is_check === false || item.is_check === 0;\n      })\n      if(index){\n        this.isRadio = false; \n      }else{\n        // 如果列表内容不为空\n        if(this.cartData.length){\n          this.isRadio = true;\n        }else{\n          this.isRadio = false;\n        }\n      }\n    },\n    totalPrice(){\n      // 得到选中的商品\n      // 总价格\n      let resultPrice = 0;\n      // 总数量\n      let totalCommodity = 0;\n      const resultArr = this.cartData.filter(item =>{\n        return item.is_check === 1 || item.is_check === true\n      })\n      for (let i = 0; i < resultArr.length; i++) {\n       resultPrice += Number(resultArr[i].goods_price) * resultArr[i].goods_num;\n       totalCommodity += resultArr[i].goods_num;\n      }\n      this.resultPrice = resultPrice.toFixed(2);\n      this.totalCommodity = totalCommodity;\n    },\n    // 结算商品\n    shoppingSettlement(){\n      if(!this.totalCommodity == 0){\n        uni.navigateTo({\n          url:'/pages/carts/buy/buy'\n        })\n      }\n    },\n    changeCartNum(){\n      this.$request.GET({\n        url:this.$api.apiUrl.GET_GOODS_CART,\n      }).then(res=>{\n        if(res.data.length){\n          uni.setTabBarBadge({\n            index: 1,\n            text: String(res.data.length)\n          })\n        }else{\n          uni.setTabBarBadge({\n            index: 1,\n            text: \"0\"\n          })\n        }\n      })\n    },\n    navToLogin(){\n      // 页面鉴权\n      const TOKEN = uni.getStorageSync('access_token');\n      if(!this.isWrapShow){\n          if (!TOKEN){\n          uni.navigateTo({\n            url:\"/pages/mys/login/login\",\n            success:()=>{\n              this.isWrapShow = true;\n            }\n          })\n        }else{\n          this.isWrapShow = true;\n        }\n      }else{\n        if (!TOKEN){\n          uni.switchTab({\n              url:\"/pages/indexs/index/index\",\n              success:()=>{\n                this.isWrapShow = false;\n              }\n          })\n        }\n      }\n    }\n  },\n};\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}