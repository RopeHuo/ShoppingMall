{"version":3,"sources":["webpack:///./src/main.js","webpack:///./src/pages/mys/login/login.vue?11a1","webpack:///./src/pages/mys/login/login.vue?9303","webpack:///./src/pages/mys/login/login.vue?bc75","webpack:///./src/pages/mys/login/login.vue?1143","webpack:///./src/pages/mys/login/login.vue","webpack:///./src/pages/mys/login/login.vue?65be"],"names":["createPage","Page","component","options","__file","render","_h","this","$createElement","_self","_c","staticRenderFns","_withStripped","createNamespacedHelpers","mapState","data","mobile","password","logining","isActive","phoneType","randNum","onLoad","methods","mapMutations","navBack","uni","navigateBack","toRegist","navigateTo","url","toLogin","$api","msg","showLoading","title","staff","userLogin","typeSwitch","e","$request","POST","apiUrl","POST_USER_LOGIN","username","then","res","hideLoading","code","setStorage","key","success","Promise","all","LOGIN","isLogin","showToast","switchTab","fail","icon","getSystemInfo","platform","$fnHelper","randomWord","POST_V6_USER_APP_SERECT","device_uuid","device_type","result","storageToken","getStorageSync","JSON","parse","signMd5","app_id","app_secret","POST_V6_USER_TOKEN","MD5","verifyLogin","CryptoJS","enc","Latin1","Base64","decode","sessionKey","iv","AES","encrypt","mode","CBC","padding","pad","ZeroPadding","POST_V6_USER_LOGIN","token"],"mappings":"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","file":"pages/mys/login/login.js","sourcesContent":["import 'uni-pages';\n\nimport Vue from 'vue'            \nimport Page from './pages/mys/login/login.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=1466ad27&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/Rope/master/Desktop/mix-mall/cli_ShoppingMall/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('1466ad27')) {\n      api.createRecord('1466ad27', component.options)\n    } else {\n      api.reload('1466ad27', component.options)\n    }\n    module.hot.accept(\"./login.vue?vue&type=template&id=1466ad27&\", function () {\n      api.rerender('1466ad27', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pages/mys/login/login.vue\"\nexport default component.exports","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=template&id=1466ad27&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { createNamespacedHelpers } from 'vuex';\nconst { mapState, mapMutations } = createNamespacedHelpers('storeCommodity');\nimport MD5 from '@/common/MD5.js';\nimport Base64 from '@/common/base64.js';\nimport CryptoJS from '@/common/crypto.js';\n\nexport default {\n  data() {\n    return {\n      mobile: '',\n      password: '',\n      logining: false,\n\t  isActive: 0,\n\t  phoneType:2,\n\t  randNum:'',\n\t  ...mapState(['isLogin'])\n    };\n  },\n  onLoad() {\n\t\n  },\n  methods: {\n    ...mapMutations(['LOGIN']),\n    navBack() {\n      uni.navigateBack();\n    },\n    toRegist() {\n      uni.navigateTo({\n\t\t  url:\"/pages/mys/register/register\"\n\t  })\n    },\n    async toLogin() {\n\t\tif(this.mobile === ''){\n\t\t\tthis.$api.msg(\"请输入用户名\")\n\t\t\treturn false;\n\t\t}\n\t\tif(this.password === ''){\n\t\t\tthis.$api.msg(\"请输入密码\")\n\t\t\treturn false;\n\t\t}\n\t\tuni.showLoading({\n\t\t\ttitle: '正在登录中'\n\t\t});\n\t\t// 判断查看是那个员工登录\n\t\tif(this.isActive){\n\t\t\tthis.staff();\n\t\t}else{\n\t\t\tthis.userLogin();\n\t\t}\n    },\n    typeSwitch(e) {\n\t  this.isActive = e;\n\t},\n\tuserLogin(){\n\t\tthis.$request.POST({\n\t\t\turl:this.$api.apiUrl.POST_USER_LOGIN,\n\t\t\tdata:{\n\t\t\t\tusername:this.mobile,\n\t\t\t\tpassword:this.password\n\t\t\t}\n\t\t}).then(res => {\n\t\t\tuni.hideLoading();\n\t\t\tif(res.code === 200){\n\t\t\t\tuni.setStorage({\n\t\t\t\t\tkey: 'access_token',\n\t\t\t\t\tdata: res.data,\n\t\t\t\t\tsuccess:()=>{\n\t\t\t\t\t\tPromise.all([this.LOGIN({\"isLogin\":!this.isLogin()})]).then(() =>{\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: res.msg\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\t\t\turl:\"/pages/mys/user/user\"\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\t\t\n\t\t\t\t\t},\n\t\t\t\t\tfail:()=>{\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: \"Token设置失败，请重新操作\"\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle:res.msg,\n\t\t\t\t\ticon:\"none\"\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t},\n\tstaff(){\n\t\t// 获取什么设备\n\t\tuni.getSystemInfo({\n\t\t\tsuccess: (res)=> {\n\t\t\t\tlet platform = res.platform;\n\t\t\t\tif(platform === \"devtools\"){\n\t\t            this.phoneType = 2;\n\t\t\t\t}else if(platform === \"ios\"){\n\t\t            this.phoneType = 1;\n\t\t\t\t}else if(platform === \"android\"){\n\t\t            this.phoneType = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t// 设置随机码\n\t\tif(!this.randNum){\n\t\t\tlet randNum = this.$fnHelper.randomWord(true, 32, 32);\n\t\t\tthis.randNum = randNum;\n\t\t}\n\t\tthis.$request.POST({\n\t\t\turl:this.$api.apiUrl.POST_V6_USER_APP_SERECT,\n\t\t\tdata:{\n\t\t\t\tdevice_uuid:this.randNum,\n\t\t\t\tdevice_type:this.phoneType\n\t\t\t}\n\t\t}).then(res=>{\n\t\t\tlet result = res.data;\n\t\t\tif(res.code === 'SUCCESS'){\n\t\t\t\tlet storageToken = uni.getStorageSync(\"token\")\n\t\t\t\t?uni.getStorageSync(\"token\")\n\t\t\t\t:null;\n\t\t\t\tlet oToken = JSON.parse(storageToken);\n\t\t\t\tif(oToken === null){\n\t\t\t\t\tlet signMd5 = this.randNum+result.app_id+result.app_secret+'i$6xtmclRStow$uj&rj7uFj^ZnV8&WyN';\n\t\t\t\t\tthis.$request.POST({\n\t\t\t\t\t\turl:this.$api.apiUrl.POST_V6_USER_TOKEN,\n\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\"app_id\": result.app_id,\n\t\t\t\t\t\t\t\"app_secret\": result.app_secret,\n\t\t\t\t\t\t\t\"sign\": signMd5.MD5(32)\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(res=>{\n\t\t\t\t\t\tif(res.code === 'SUCCESS'){\n\t\t\t\t\t\t\tthis.verifyLogin(res.data);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t},\n\tverifyLogin(data){\n\t\t// AES加密\n\t\t// 为了避免补位，直接用16位的密钥\n\t\tlet key = CryptoJS.enc.Latin1.parse(Base64.decode(data.sessionKey));\n\t\t// 16位初始向量\n\t\tlet iv = CryptoJS.enc.Latin1.parse(Base64.decode(data.iv)); \n\t\t\n\t\t// Encrypt\n\t    let username = CryptoJS.AES.encrypt(this.mobile, key, {\n\t    \tiv: iv,\n\t    \tmode: CryptoJS.mode.CBC,\n\t    \tpadding: CryptoJS.pad.ZeroPadding\n\t    });\n\t    let password = CryptoJS.AES.encrypt(this.password, key, {\n\t    \tiv: iv,\n\t    \tmode: CryptoJS.mode.CBC,\n\t    \tpadding: CryptoJS.pad.ZeroPadding\n\t    });\n\t\tthis.$request.POST({\n\t\t\turl:this.$api.apiUrl.POST_V6_USER_LOGIN,\n\t\t\tdata:{\n\t\t\t\t\"token\": data.token,\n\t\t\t\t\"username\": ''+username,\n\t\t\t\t\"password\": ''+password\n\t\t\t}\n\t\t}).then(res=>{\n\t\t\tif(res.code == 'SUCCESS'){\n\t\t    \tuni.showToast({\n\t\t\t\t\ttitle:res.msg,\n\t\t\t\t\tsuccess:()=>{\n\t\t\t\t\t\tuni.setStorage({\n\t\t\t\t\t\t\tkey: 'access_token',\n\t\t\t\t\t\t\tdata: data.token,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tuni.switchTab({\n\t\t\t\t\t\t\turl:\"/pages/mys/user/user\"\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t    }else{\n\t\t    \tthis.$api.msg(res.msg)\n\t\t    }\n\t\t})\n\t}\n  }\n};\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=scss&\""],"sourceRoot":""}