{"version":3,"sources":["webpack:///./src/pages/cart/cart/cart.vue?aac4","webpack:///./src/pages/cart/cart/cart.vue?4e82","webpack:///./src/main.js","webpack:///./src/pages/cart/cart/cart.vue?401c","webpack:///./src/pages/cart/cart/cart.vue?32a5","webpack:///./src/pages/cart/cart/cart.vue?ab3b","webpack:///./src/pages/cart/cart/cart.vue?e683","webpack:///./src/pages/cart/cart/cart.vue"],"names":["createPage","Page","components","UniNumberBox","data","total","allChecked","empty","cartList","onLoad","loadData","watch","e","length","computed","methods","$api","json","list","map","item","checked","calcTotal","onImageLoad","key","index","$set","onImageError","image","navToLogin","uni","navigateTo","url","check","type","forEach","numberChange","number","deleteCartItem","row","id","splice","hideLoading","clearCart","showModal","content","success","confirm","price","Number","toFixed","createOrder","goodsData","push","attr_val","JSON","stringify","msg"],"mappings":"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","file":"pages/cart/cart/cart.js","sourcesContent":["import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1570611378108\n      var cssReload = require(\"/Users/Rope/master/Desktop/mix-mall/cli_ShoppingMall/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import 'uni-pages';\n\nimport Vue from 'vue'            \nimport Page from './pages/cart/cart/cart.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./cart.vue?vue&type=template&id=05e00004&\"\nimport script from \"./cart.vue?vue&type=script&lang=js&\"\nexport * from \"./cart.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cart.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/Rope/master/Desktop/mix-mall/cli_ShoppingMall/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('05e00004')) {\n      api.createRecord('05e00004', component.options)\n    } else {\n      api.reload('05e00004', component.options)\n    }\n    module.hot.accept(\"./cart.vue?vue&type=template&id=05e00004&\", function () {\n      api.rerender('05e00004', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/pages/cart/cart/cart.vue\"\nexport default component.exports","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=template&id=05e00004&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cart.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  mapState,\n} from 'vuex';\nimport UniNumberBox from '@/components/UniNumberBox/UniNumberBox.vue';\n\nexport default {\n  components: {\n    UniNumberBox,\n  },\n  data() {\n    return {\n      total: 0, // 总价格\n      allChecked: false, // 全选状态  true|false\n      empty: false, // 空白页现实  true|false\n      cartList: [],\n    };\n  },\n  onLoad() {\n    this.loadData();\n  },\n  watch: {\n    // 显示空白页\n    cartList(e) {\n      const empty = e.length === 0;\n      if (this.empty !== empty) {\n        this.empty = empty;\n      }\n    },\n  },\n  computed: {\n    ...mapState(['hasLogin']),\n  },\n  methods: {\n    // 请求数据\n    async loadData() {\n      const list = await this.$api.json('cartList');\n      const cartList = list.map((item) => {\n        item.checked = true;\n        return item;\n      });\n      this.cartList = cartList;\n      this.calcTotal(); // 计算总价\n    },\n    // 监听image加载完成\n    onImageLoad(key, index) {\n      this.$set(this[key][index], 'loaded', 'loaded');\n    },\n    // 监听image加载失败\n    onImageError(key, index) {\n      this[key][index].image = '/static/errorImage.jpg';\n    },\n    navToLogin() {\n      uni.navigateTo({\n        url: '/pages/public/login',\n      });\n    },\n\t\t\t // 选中状态处理\n    check(type, index) {\n      if (type === 'item') {\n        this.cartList[index].checked = !this.cartList[index].checked;\n      } else {\n        const checked = !this.allChecked;\n        const list = this.cartList;\n        list.forEach((item) => {\n          item.checked = checked;\n        });\n        this.allChecked = checked;\n      }\n      this.calcTotal(type);\n    },\n    // 数量\n    numberChange(data) {\n      this.cartList[data.index].number = data.number;\n      this.calcTotal();\n    },\n    // 删除\n    deleteCartItem(index) {\n      const list = this.cartList;\n      const row = list[index];\n      const { id } = row;\n\n      this.cartList.splice(index, 1);\n      this.calcTotal();\n      uni.hideLoading();\n    },\n    // 清空\n    clearCart() {\n      uni.showModal({\n        content: '清空购物车？',\n        success: (e) => {\n          if (e.confirm) {\n            this.cartList = [];\n          }\n        },\n      });\n    },\n    // 计算总价\n    calcTotal() {\n      const list = this.cartList;\n      if (list.length === 0) {\n        this.empty = true;\n        return;\n      }\n      let total = 0;\n      let checked = true;\n      list.forEach((item) => {\n        if (item.checked === true) {\n          total += item.price * item.number;\n        } else if (checked === true) {\n          checked = false;\n        }\n      });\n      this.allChecked = checked;\n      this.total = Number(total.toFixed(2));\n    },\n    // 创建订单\n    createOrder() {\n      const list = this.cartList;\n      const goodsData = [];\n      list.forEach((item) => {\n        if (item.checked) {\n          goodsData.push({\n            attr_val: item.attr_val,\n            number: item.number,\n          });\n        }\n      });\n\n      uni.navigateTo({\n        url: `/pages/order/createOrder?data=${JSON.stringify({\n          goodsData,\n        })}`,\n      });\n      this.$api.msg('跳转下一页 sendData');\n    },\n  },\n};\n"],"sourceRoot":""}